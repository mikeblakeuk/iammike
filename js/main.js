function dropAll(){for(i=removedPics;i<uptoelement;i++){$("#cat"+i+" .pin").remove();$("#cat"+i+" .pinB").remove();$("#cat"+i).animate({"margin-top":"110%"},500,function(){$(this).remove()});removedPics++}removedPics=0;uptoelement=0}function dropPics(){dropNum=uptoelement-maxPics;if(dropNum>removedPics){for(i=removedPics;i<dropNum;i++){$("#cat"+i+" .pin").remove();$("#cat"+i+" .pinB").remove();$("#cat"+i).delay(50+50*i).animate({"margin-top":"110%"},500,function(){$(this).remove()});removedPics++}}}function getCats(){dWidth=$("#cats").width()-150;dHeight=$("#cats").height()-160;if(dWidth*dHeight>7e5){maxPics=25}else if(dWidth*dHeight>9e5){maxPics=35}else if(dWidth*dHeight>125e4){maxPics=45}load_counter=0;$.getJSON("/cats.php?w="+dWidth+"&h="+dHeight+"&key="+ajaxkey+"&high="+highID,function(e,t,n){highID=e.jsonPaging.highID;$.each(e.jsonImages,function(t,n){numsArray=n.nums.split(",");$("#catsFrame").append('<a href="'+n.link+'" id="cat'+uptoelement+'" class="picA" style="top: '+numsArray[1]+"px; left: "+numsArray[0]+"px; -webkit-transform: rotate("+numsArray[2]+"deg); -moz-transform: rotate("+numsArray[2]+"deg); -ms-transform: rotate("+numsArray[2]+"deg); transform: rotate("+numsArray[2]+'deg);"><span style="left: '+numsArray[5]+"px; top: "+numsArray[6]+'px;" class="pin pC'+numsArray[3]+'"></span><span style="right: '+numsArray[7]+"px; top: "+numsArray[8]+'px;" class="pinB pC'+numsArray[4]+'"></span><span class="uname">@'+n.username+"</span></a>");$('<img src="'+n.pic+'" id="catImg'+uptoelement+'">').load(function(){useThisID=$(this).attr("id").replace("catImg","");$(this).appendTo("#cat"+useThisID);$("#cat"+useThisID).delay(100+load_counter*100).fadeIn(100);load_counter++;if(load_counter==e.jsonImages.length){setTimeout(function(){dropPics();$("#fetchingCats").fadeOut("fast");$("#moreCats").fadeIn("fast")},1e3)}}).error(function(){load_counter++;if(load_counter==e.jsonImages.length){setTimeout(function(){dropPics();$("#fetchingCats").fadeOut("fast");$("#moreCats").fadeIn("fast")},1e3)}});uptoelement++})})}$(document).ready(function(){$("#slideOut").on("click",function(){$("#slideOut").fadeOut("fast");$("#details").animate({"margin-left":"-95%"},500,function(){$("#fetchingCats").fadeIn("fast");getCats();$("#slideIn").fadeIn("fast")})});$("#slideIn").on("click",function(){$("#slideIn").fadeOut("fast");dropAll();$("#moreCats").fadeOut("fast");$("#details").delay(1200).animate({"margin-left":"0"},500,function(){$("#slideOut").fadeIn("fast")})})});var highID=0;var maxPics=15;var removedPics=0;var uptoelement=0;$(document).ready(function(){if($(document).height()>$(window).height()){useHeight=$(document).height()}else{useHeight=$(window).height()}$("#cats").height($(document).height());$("#details").height($(document).height());$("#detailsCopy").height($(document).height());$("#moreCats").on("click",function(){$("#fetchingCats").fadeIn("fast");$("#moreCats").fadeOut("fast");getCats()});$(window).resize(function(){$("#cats").height($(window).height());$("#details").height($(window).height());$("#detailsCopy").height($(window).height())})})